/**
* \copyright
* MIT License
*
* Copyright (c) 2020 Infineon Technologies AG
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE
*
* \endcopyright
*
* \author Infineon Technologies AG
*
* \file rsa_key_object_confidentiality.h
*
* \brief   This file provides the data set for protected update of rsa key object with confidentiality.
*
* \ingroup grOptigaExamples
*
* @{
*/

#include <stdint.h>

/**
 * Manifest for RSA key update with integrity and confidentiality
 */
const uint8_t manifest_rsa_key[] =
{
    // COSE Sign1 Trust
    0x84,
        // Protected signed header trust
        0x47,
            // Trust Sign Algorithm
            0xA1, 
            // RSA
            0x01, 0x3A, 0x00, 0x01, 0x00, 0xA3, 
        // Unprotected signed header trust
        0xA1, 
            // Root of trust
            0x04, 0x42, 
            // Trust Anchor OID
            0xE0, 0xE3, 
        // Payload info Byte string of single byte length
        0x58, 
            // Byte string length of manifest            
            0x9E, 
            // Trust manifest, array of 6 entries
            0x86, 
            // Version(Major Type 0)
            0x01,
            // NULL
            0xF6,
            // NULL
            0xF6,
            // Resources, array of 4 entries
            0x84, 
                // Trust Payload Type
                0x22,
                // Payload Length 
                0x19, 0x01, 0x0D,
                // Trust Payload version
                0x03, 
                // Trust Add info data 
                0x82, 
                    // key algorithm
                    0x18,
                    // key usage
                    0x41, 0x12, 
                // Trust Processors, array of 2 entries 
                0x82, 
                    // Processing step integrity, array of 2 entries
                    0x82, 
                        // Process( Major Type 1)
                        0x20, 
                        // Parameters, byte string with single byte length
                        0x58, 
                            // Byte string length 
                            0x25, 
                            // IFX Digest info, array of 2 entries
                            0x82, 
                                // Digest Algorithm
                                0x18,
                                    // SHA-256
                                    0x29, 
                                // Digest
                                0x58, 
                                    // Byte string length
                                    0x20, 
                                        // Digest data
                                        0xDC, 0x9A, 0x2F, 0xEF, 0x36, 0x27, 0x6C, 0x01,
                                        0xC0, 0x64, 0x00, 0x69, 0xEA, 0x9A, 0x77, 0x4C,
                                        0x23, 0x53, 0x43, 0x0E, 0x54, 0xBE, 0x36, 0x21,
                                        0x98, 0x7A, 0xFD, 0x84, 0x92, 0x2B, 0xC6, 0x2D,
                    // Processing step decrypt, array of 2 entries
                    0x82,
                        // Process( Major Type 0)
                        0x01,
                        // COSE_Encrypt_Trust array of 3 entries
                        0x83,
                            // protected-encrypt-header-Trust
                            0x43,
                                // Map 
                                0xA1,
                                    // Key 
                                    0x01,
                                    // AES-CCM-16-64-128, 128-bit key, 64-bit Authentication(MAC) tag, 13-byte nonce
                                    0x0A,
                            // recipients array of 1
                            0x81,
                                // COSE_Recipient_Trust array of 2
                                0x82,
                                    // protected-recipient-header-Trust
                                    0x58,
                                        // byte str
                                        0x54,
                                            // Map of 3
                                            0xA3,
                                                // Key
                                                0x04,
                                                // Value
                                                0x42,
                                                    // Shared secret OID
                                                    0xF1, 0xD1,
                                                // Key
                                                0x01,
                                                // Value (KeyDerivationAlgorithms)
                                                0x3A, 0x00, 0x01, 0x00, 0xB7,
                                                // Key
                                                0x05,
                                                // Value array of 2
                                                0x82,
                                                    0x44,
                                                        // label(4)
                                                        0x74, 0x65, 0x73, 0x74,
                                                    0x58,
                                                        0x40,
                                                        // seed(64)
                                                        0x10, 0x51, 0xF4, 0x48, 0x77, 0xF3, 0x24, 0xAC,
                                                        0xB9, 0xE1, 0xCF, 0x89, 0xC7, 0x22, 0x98, 0x3A,
                                                        0xBE, 0x74, 0x7C, 0x05, 0x6E, 0xC4, 0xFB, 0x66,
                                                        0x4F, 0xC4, 0x57, 0xB9, 0x23, 0xDC, 0x6C, 0xA0,
                                                        0x20, 0x62, 0xCC, 0xB0, 0x02, 0x0D, 0x7B, 0x8C, 
                                                        0x9D, 0x02, 0x4C, 0xF3, 0x7B, 0x3E, 0xAD, 0x12,
                                                        0x14, 0xC2, 0x14, 0x2B, 0xB3, 0xF7, 0x96, 0x48,
                                                        0xC8, 0x29, 0x2C, 0x19, 0x14, 0xEF, 0x0C, 0x92,
                                    // ciphertext-recipient-header-Trust
                                    0xF6,
                            // AdditionalInfo
                            0xF6,
                // Trust Target
                0x82, 
                    // Component identifier(0)
                    0x40,
                    // Storage identifier
                    0x42, 
                    // Optiga target OID
                    0xE0, 0xFC, 
        // Signature info, byte string of single byte length
        0x58, 
            // Byte string length for RSA 1024
            0x80, 
            // Signature data
            0xE0, 0xD3, 0x80, 0x3B, 0xC9, 0x6F, 0x2A, 0xB6, 0x2C, 0x71, 0x0A, 0x75, 0x92, 0x07, 0x75, 0x32,
            0x56, 0x46, 0xAC, 0x52, 0x95, 0xF3, 0xBD, 0x2A, 0x66, 0xA7, 0x41, 0x0B, 0x39, 0xAD, 0xEE, 0x5F,
            0xBE, 0x23, 0xC8, 0xC6, 0xE5, 0xAF, 0x62, 0xEF, 0x04, 0x9D, 0x30, 0x87, 0x9E, 0xAA, 0xFC, 0xF0,
            0xEF, 0x36, 0x0D, 0xCC, 0x3E, 0x65, 0x19, 0x2A, 0xA6, 0x10, 0x3D, 0x02, 0x64, 0xD3, 0x36, 0xEE,
            0xE8, 0xD7, 0xDC, 0xC6, 0x78, 0x9C, 0xEF, 0xFD, 0xEF, 0x62, 0xF0, 0xCD, 0xF3, 0x8E, 0xAC, 0x31,
            0x31, 0xDD, 0x70, 0xDA, 0x9F, 0x63, 0x0F, 0x8A, 0x95, 0x01, 0xD0, 0x39, 0x2E, 0x9E, 0x15, 0x08,
            0x64, 0x52, 0x96, 0x4D, 0x27, 0x01, 0x5B, 0x25, 0x12, 0x19, 0xA8, 0xCE, 0x38, 0x67, 0xB7, 0xFD,
            0xD7, 0xBB, 0xF6, 0xDA, 0x73, 0x62, 0xC2, 0xF1, 0xA4, 0xF9, 0xCE, 0xB8, 0x63, 0x45, 0xE6, 0x8D,

};


/**
 * Fragment array for final payload for RSA key update
 */
const uint8_t rsa_key_final_fragment_array[] =
{
    0xEE, 0xAE, 0x29, 0xC1, 0x62, 0x92, 0x4E, 0xAD, 0x9F, 0xFD, 0x1D, 0xE7, 0xBC, 0x04, 0x73, 0x5C,
    0x3E, 0x20, 0x5F, 0xC5, 0xBA, 0x28, 0x3F, 0x8A, 0xC7, 0xEB, 0x01, 0xDE, 0x71, 0x11, 0xF8, 0xCC,
    0x0C, 0x21, 0x91, 0x5B, 0x71, 0xCA, 0xE8, 0x4F, 0x74, 0x4E, 0x6F, 0x32, 0x54, 0xD9, 0x29, 0xBD,
    0xFC, 0xEC, 0x7D, 0xB8, 0xE0, 0xA6, 0x08, 0x8E, 0xCE, 0x74, 0xD4, 0x43, 0x90, 0x93, 0xC8, 0x7E,
    0xFF, 0x4E, 0x69, 0x7C, 0x28, 0x80, 0x6B, 0xBA, 0x3A, 0xB3, 0xD2, 0x51, 0xC8, 0x7A, 0xC9, 0x45,
    0xE4, 0x37, 0x06, 0x7F, 0xB2, 0xAE, 0xE5, 0xC0, 0xE5, 0xFC, 0xE1, 0xF6, 0x52, 0x7E, 0xBC, 0x89,
    0xF3, 0x76, 0x8C, 0x59, 0x2B, 0x85, 0x00, 0x2D, 0xBB, 0x43, 0xE6, 0x83, 0xDC, 0x7D, 0xB1, 0x4D,
    0x37, 0xCF, 0xA8, 0x08, 0xD2, 0x2E, 0x02, 0xF7, 0x53, 0x27, 0x75, 0x1F, 0xE7, 0x37, 0xF9, 0x7E,
    0x0E, 0xD0, 0xB9, 0xAD, 0x67, 0x0E, 0xE4, 0x93, 0xC4, 0xA7, 0xFC, 0x12, 0xF5, 0x4E, 0x80, 0xF4,
    0x4A, 0x29, 0x74, 0xA1, 0x3F, 0xEE, 0xA1, 0xCB, 0x28, 0x4E, 0xE4, 0x8C, 0x7C, 0xA9, 0x53, 0xE5,
    0x07, 0xE8, 0x37, 0x19, 0x12, 0xD1, 0x48, 0xA6, 0x1F, 0xFD, 0x78, 0x09, 0x07, 0x27, 0x6F, 0x9C,
    0x02, 0xC0, 0x08, 0x31, 0xC2, 0x0B, 0x1E, 0xEB, 0x64, 0x4D, 0x76, 0xB8, 0x68, 0xA9, 0x8C, 0x38,
    0x62, 0x33, 0x27, 0x6F, 0x4F, 0x95, 0xD7, 0x15, 0xF1, 0x21, 0xD6, 0x8F, 0x1F, 0xC8, 0xC9, 0x58,
    0x10, 0xEC, 0xD5, 0x03, 0x40, 0xF0, 0xCF, 0xF2, 0x7F, 0x3B, 0x6F, 0x8B, 0x98, 0xE3, 0x4B, 0xD0,
    0x3E, 0xFF, 0x6A, 0xA1, 0xFE, 0x8E, 0xBF, 0x72, 0x78, 0xE3, 0x6F, 0x01, 0xCB, 0x22, 0x67, 0xB6,
    0x35, 0xEA, 0xB0, 0x05, 0xDF, 0x15, 0x84, 0x58, 0x43, 0xCD, 0xC4, 0xA7, 0xC3, 0xAE, 0x21, 0xB3,
    0xD8, 0xC4, 0x87, 0x70, 0xEC, 0x75, 0xA8, 0xE2, 0xE4, 0x6B, 0x11, 0xF7, 0x64, 0x89, 0x41, 0x77,
    0x89, 0x23, 0x34, 0xA7, 0x8C,
};

/**
* @}
*/
